# 이번 주 구현 사항 요약 (Decal 집중)

아래 항목들은 이번 주에 추가/개선한 데칼(Decal) 관련 기능들입니다. 에디터/PIE에서 바로 써볼 수 있도록 사용법도 함께 정리했습니다.

## 구현 목록
- 데칼 액터/컴포넌트 체계
  - `ADecalActor` + `UDecalComponent` 구성으로 씬에 배치/관리
  - 머티리얼(텍스처) 지정, 페이드 인/아웃, 투명도 등 렌더 파라미터 제어
- 데칼 최적화: BVH, SAT
  - BVH 기반 레이캐스트/프러스텀 컬링으로 빠른 피킹/가시성 테스트
  - 데칼 프로젝션 시 충돌 후보를 OBB(AABB)와 SAT 테스트로 축소해 과연산 방지
- 다양한 페이드 애니메이션 옵션
  - `StartFadeIn(Duration, Delay)` / `StartFadeOut(Duration, Delay, bDestroyOwner)`
  - 지연 시작, 페이드 시간, 페이드 완료 시 자동 삭제 옵션 지원
- 데칼을 이용한 스포트라이트(Spotlight) 연출
  - 프로젝션 데칼 파이프라인을 활용해 텍스처/마스크 기반의 라이트 효과 구현
- PIE 모드: 클릭한 지점에 총알구멍 데칼 생성 + 자동 Fade out & 삭제
  - 화면에서 클릭(레이캐스트)된 표면에 데칼 액터 스폰
  - 페이드 아웃 완료 시 컴포넌트 또는 액터를 안전하게 제거(지연 삭제)

## 빠른 사용법
- 씬에 데칼 배치
  - 에디터에서 액터 추가: “Decal Actor” 생성 → 위치/회전/스케일 조정
  - 머티리얼(텍스처) 선택은 Actor Detail 패널에서 지정
- 페이드 애니메이션
  - Detail 패널에서 페이드 파라미터(지연, 지속시간, 완료 시 삭제)를 설정
  - 코드 제어: `UDecalComponent::StartFadeIn/Out(...)` 호출
- 스포트라이트 데칼
  - 스포트라이트용 텍스처(마스크) 머티리얼을 데칼에 지정해 라이트 효과 연출
- 총알구멍(PIE 전용)
  - PIE 실행 후, 화면을 클릭하면 레이캐스트 히트 지점에 데칼 액터 생성
  - 생성 즉시 페이드 아웃 타이머가 시작되고, 완료 시 자동 삭제

## 성능 & 안정성 메모
- BVH 가속
  - 레이캐스트: BVH를 통해 최근접 프리미티브를 O(log N) 수준으로 조회
  - 프러스텀 컬링: 화면 밖 프리미티브/데칼은 초기 단계에서 배제
- SAT/OBB 테스트
  - 데칼 프로젝션 시 화면 후보 프리미티브와의 교차 판정을 보수적으로 최적화
- 안전한 삭제(지연 삭제)
  - 페이드 완료 시 즉시 삭제하지 않고, 다음 틱에서 안전하게 제거
  - 컴포넌트 제거도 액터 틱 종료 후 일괄 처리해 이터레이터 무효화 방지

## 디버그/통계
- 콘솔 `stat decal`
  - “Decal : X.XXXms, Decals : N” 형식으로 데칼 렌더링 누적시간과 총 개수 표시
  - FPS/메모리 오버레이와 함께 On/Off 가능
