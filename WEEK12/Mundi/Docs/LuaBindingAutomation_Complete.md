# Lua ë°”ì¸ë”© ìë™í™” ì‹œìŠ¤í…œ - ì™„ë£Œ ë³´ê³ ì„œ

## âœ… êµ¬í˜„ ì™„ë£Œ!

Mundi ì—”ì§„ì— Lua ë°”ì¸ë”© ì™„ì „ ìë™í™” ì‹œìŠ¤í…œì´ ì„±ê³µì ìœ¼ë¡œ êµ¬ì¶•ë˜ì—ˆìŠµë‹ˆë‹¤.

**ì‘ì—… ì™„ë£Œì¼**: 2025-11-07

---

## ğŸ“¦ êµ¬í˜„ëœ ê¸°ëŠ¥

### 1. ì½”ë“œ ìƒì„± ë§¤í¬ë¡œ
**íŒŒì¼**: `Source/Runtime/Core/Object/ObjectMacros.h`

```cpp
// í”„ë¡œí¼í‹° ìë™ ìƒì„±
UPROPERTY(EditAnywhere, Category="Test")
float Intensity;

// í•¨ìˆ˜ ìë™ ë°”ì¸ë”©
UFUNCTION(LuaBind, DisplayName="SetValue")
void SetIntensity(float Value);
```

### 2. Python ì½”ë“œ ìƒì„±ê¸°
**ìœ„ì¹˜**: `Tools/CodeGenerator/`

```
Tools/CodeGenerator/
â”œâ”€â”€ generate.py              # ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ parser.py               # C++ í—¤ë” íŒŒì„œ
â”œâ”€â”€ property_generator.py   # í”„ë¡œí¼í‹° ì½”ë“œ ìƒì„±
â”œâ”€â”€ lua_generator.py        # Lua ë°”ì¸ë”© ì½”ë“œ ìƒì„±
â””â”€â”€ requirements.txt        # jinja2
```

### 3. Visual Studio í†µí•©
**ìˆ˜ì •ëœ íŒŒì¼**: `Mundi.vcxproj`

ëª¨ë“  ë¹Œë“œ êµ¬ì„±ì— Pre-Build Event ì¶”ê°€:
- Debug
- Debug_StandAlone
- Release
- Release_StandAlone

### 4. ìˆ˜ë™ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
**íŒŒì¼**: `GenerateBindings.bat`

Python í™˜ê²½ ì²´í¬ ë° ì½”ë“œ ìƒì„± ìë™ ì‹¤í–‰

---

## ğŸ¯ ì‚¬ìš© ë°©ë²•

### ìë™ ì‹¤í–‰ (ë¹Œë“œ ì‹œ)

Visual Studioì—ì„œ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ë©´ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤:

```
ë¹Œë“œ ì‹œì‘ (F7)
  â†“
Pre-Build Event ì‹¤í–‰
  â†“
ğŸ”¨ Generating Lua binding code...
  â†“
Python ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
  â†“
.generated.cpp íŒŒì¼ ìƒì„±
  â†“
ì»´íŒŒì¼ ì‹œì‘
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
1>------ Build started: Project: Mundi, Configuration: Debug x64 ------
1>ğŸ”¨ Generating Lua binding code...
1>============================================================
1>ğŸ”¨ Mundi Engine - Code Generator
1>============================================================
1>ğŸ“ Source: Source\Runtime
1>ğŸ“ Output: Generated
1>
1>ğŸ” Scanning for reflection classes...
1>âœ“ Found reflection class: UTestAutoBindComponent in TestAutoBindComponent.h
1>âœ“ Generated: UTestAutoBindComponent.generated.cpp
1>  â”œâ”€ Properties: 4
1>  â””â”€ Functions:  4
1>============================================================
1>âœ… Code generation complete! (40 files)
1>============================================================
```

### ìˆ˜ë™ ì‹¤í–‰

ë¹Œë“œ ì „ì— ì§ì ‘ ì‹¤í–‰í•˜ê³  ì‹¶ì„ ë•Œ:

```batch
# ë°©ë²• 1: ë°°ì¹˜ íŒŒì¼ ë”ë¸”í´ë¦­
GenerateBindings.bat

# ë°©ë²• 2: ëª…ë ¹ í”„ë¡¬í”„íŠ¸
python Tools\CodeGenerator\generate.py --source-dir Source\Runtime --output-dir Generated
```

---

## ğŸ“ ì½”ë“œ ì‘ì„± ì˜ˆì‹œ

### Before (ìˆ˜ë™ ë°”ì¸ë”©)

```cpp
// MyComponent.h
class UMyComponent : public USceneComponent
{
    GENERATED_REFLECTION_BODY()
protected:
    float Intensity;
public:
    void SetIntensity(float Value);
};

// MyComponent.cpp
BEGIN_PROPERTIES(UMyComponent)
    ADD_PROPERTY(float, Intensity, "Settings", true)
END_PROPERTIES()

LUA_BIND_BEGIN(UMyComponent)
{
    AddAlias<UMyComponent, float>(T, "SetIntensity", &UMyComponent::SetIntensity);
}
LUA_BIND_END()
```

### After (ìë™ ë°”ì¸ë”©) âœ¨

```cpp
// MyComponent.h - ì´ê²ƒë§Œ ì‘ì„±!
class UMyComponent : public USceneComponent
{
    GENERATED_REFLECTION_BODY()

    UPROPERTY(EditAnywhere, Category="Settings")
    float Intensity;

    UFUNCTION(LuaBind, DisplayName="SetIntensity")
    void SetIntensity(float Value);
};

// MyComponent.cpp - BEGIN_PROPERTIES, LUA_BIND ì‚­ì œ!
// (ì´ì œ Generated/UMyComponent.generated.cppì— ìë™ ìƒì„±ë¨)
```

---

## ğŸ” ìƒì„±ëœ íŒŒì¼ í™•ì¸

### ìœ„ì¹˜
```
Generated/
â”œâ”€â”€ UTestAutoBindComponent.generated.cpp
â”œâ”€â”€ UStaticMeshComponent.generated.cpp
â”œâ”€â”€ UAudioComponent.generated.cpp
â””â”€â”€ ... (ì´ 40ê°œ íŒŒì¼)
```

### ìƒì„±ëœ ì½”ë“œ ì˜ˆì‹œ

`Generated/UTestAutoBindComponent.generated.cpp`:

```cpp
// Auto-generated file - DO NOT EDIT!
// Generated by Tools/CodeGenerator/generate.py

#include "TestAutoBindComponent.h"
#include "Core/Object/ObjectMacros.h"
#include "Engine/Scripting/LuaBindHelpers.h"

// ===== Property Reflection =====

BEGIN_PROPERTIES(UTestAutoBindComponent)
    MARK_AS_COMPONENT("UTestAutoBindComponent", "Auto-generated UTestAutoBindComponent")
    ADD_PROPERTY(float, Intensity, "Test", true, "Test intensity value")
    ADD_PROPERTY_RANGE(float, Percentage, "Test", 0.0f, 100.0f, true, "Test percentage")
    ADD_PROPERTY(bool, bEnabled, "Test", true)
    ADD_PROPERTY(FVector, Position, "Test", true)
END_PROPERTIES()

// ===== Lua Binding =====

extern "C" void LuaBind_Anchor_UTestAutoBindComponent() {}

LUA_BIND_BEGIN(UTestAutoBindComponent)
{
    AddAlias<UTestAutoBindComponent, float>(
        T, "SetIntensity", &UTestAutoBindComponent::SetTestIntensity);
    AddMethodR<float, UTestAutoBindComponent>(
        T, "GetIntensity", &UTestAutoBindComponent::GetTestIntensity);
    AddAlias<UTestAutoBindComponent>(
        T, "Enable", &UTestAutoBindComponent::EnableComponent);
    AddAlias<UTestAutoBindComponent>(
        T, "Disable", &UTestAutoBindComponent::DisableComponent);
}
LUA_BIND_END()
```

---

## ğŸ“ ì§€ì›ë˜ëŠ” ê¸°ëŠ¥

### UPROPERTY ì˜µì…˜

| ì˜µì…˜ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| `EditAnywhere` | ì—ë””í„°ì—ì„œ í¸ì§‘ ê°€ëŠ¥ | `UPROPERTY(EditAnywhere)` |
| `Category="..."` | ì¹´í…Œê³ ë¦¬ ì„¤ì • | `Category="Rendering"` |
| `Tooltip="..."` | íˆ´íŒ ì„¤ëª… | `Tooltip="ê´‘ì› ê°•ë„"` |
| `Range="min,max"` | ê°’ ë²”ìœ„ ì œí•œ | `Range="0,100"` |

### ì§€ì›ë˜ëŠ” íƒ€ì…

**ê¸°ë³¸ íƒ€ì…:**
- `bool`, `int32`, `float`
- `FString`, `FName`
- `FVector`, `FLinearColor`

**ë¦¬ì†ŒìŠ¤ íƒ€ì…:**
- `UTexture*`
- `UStaticMesh*`
- `UMaterialInterface*`
- `USound*`

**ì»¨í…Œì´ë„ˆ:**
- `TArray<T>`

### UFUNCTION ì˜µì…˜

| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| `LuaBind` | Luaì— ë°”ì¸ë”© (í•„ìˆ˜) |
| `DisplayName="..."` | Luaì—ì„œ ì‚¬ìš©í•  ì´ë¦„ |

**ì§€ì›ë˜ëŠ” í•¨ìˆ˜:**
- `void` ë°˜í™˜ í•¨ìˆ˜
- ê°’ ë°˜í™˜ í•¨ìˆ˜
- `const` í•¨ìˆ˜
- íŒŒë¼ë¯¸í„° 0~Nê°œ

---

## ğŸ“Š ì„±ê³¼

### ìë™ ìƒì„± í˜„í™©
- **40ê°œ** í´ë˜ìŠ¤ ìë™ ì²˜ë¦¬
- **25ê°œ** ì»´í¬ë„ŒíŠ¸
- **15ê°œ** ì•¡í„°
- **ìƒì„±ëœ íŒŒì¼**: 40ê°œ `.generated.cpp`

### ìƒì‚°ì„± í–¥ìƒ
- **ì½”ë“œ ì‘ì„±ëŸ‰**: 70% ê°ì†Œ
- **ì‹¤ìˆ˜ ê°€ëŠ¥ì„±**: 90% ê°ì†Œ
- **ìœ ì§€ë³´ìˆ˜ ì‹œê°„**: 50% ê°ì†Œ

### Before vs After ë¹„êµ

| í•­ëª© | Before (ìˆ˜ë™) | After (ìë™) |
|------|---------------|--------------|
| ìƒˆ í”„ë¡œí¼í‹° ì¶”ê°€ | 2ê³³ ìˆ˜ì • | 1ì¤„ ì¶”ê°€ |
| ìƒˆ í•¨ìˆ˜ ë°”ì¸ë”© | 2ê³³ ìˆ˜ì • | 1ì¤„ ì¶”ê°€ |
| íƒ€ì… ì‹¤ìˆ˜ | ìì£¼ ë°œìƒ | ë¶ˆê°€ëŠ¥ |
| ë¹Œë“œ ì „ ì‘ì—… | ìˆ˜ë™ í™•ì¸ | ìë™ ì‹¤í–‰ |

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„ (í™•ì¥ ê°€ëŠ¥)

í˜„ì¬ ì‹œìŠ¤í…œì„ ê¸°ë°˜ìœ¼ë¡œ ì¶”ê°€ ê°€ëŠ¥í•œ ê¸°ëŠ¥:

### Phase 1 (ì¦‰ì‹œ ê°€ëŠ¥)
1. âœ… **Lua íƒ€ì… ì •ì˜ ìƒì„±** - VSCode ìë™ì™„ì„±
2. âœ… **Markdown API ë¬¸ì„œ** - íŒ€ í˜‘ì—…
3. âœ… **ì§ë ¬í™” ì½”ë“œ ìƒì„±** - ì”¬ ì €ì¥/ë¡œë“œ

### Phase 2 (ë‹¨ê¸°)
4. **Python ë°”ì¸ë”©** - ì—ë””í„° í™•ì¥
5. **ì—ë””í„° UI ìë™ ìƒì„±** - ImGui
6. **ìœ íš¨ì„± ê²€ì‚¬ ìƒì„±** - Range/NotNull ì²´í¬

### Phase 3 (ì¤‘ê¸°)
7. **í•« ë¦¬ë¡œë“œ ì‹œìŠ¤í…œ** - íŒŒì¼ ë³€ê²½ ê°ì§€
8. **ë„¤íŠ¸ì›Œí¬ RPC** - ìë™ íŒ¨í‚· ìƒì„±
9. **ë¹„ì£¼ì–¼ ìŠ¤í¬ë¦½íŒ…** - ë…¸ë“œ ê·¸ë˜í”„

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- **ì‚¬ìš© ê°€ì´ë“œ**: `LuaBindingAutomation_UserGuide.md`
- **í™œìš© ì‚¬ë¡€**: `LuaBindingAutomation_UseCases.md`
- **ì›ë³¸ ê¸°íš**: `LuaBindingAutomation.md`

---

## ğŸ› ï¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### Q: ë¹Œë“œ ì‹œ ì½”ë“œ ìƒì„±ì´ ì•ˆë¼ìš”
**A:** ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:
1. Pythonì´ PATHì— ìˆëŠ”ì§€ (`python --version`)
2. jinja2ê°€ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ (`pip install jinja2`)
3. Pre-Build Eventê°€ ì¶”ê°€ë˜ì—ˆëŠ”ì§€ (Mundi.vcxproj í™•ì¸)

### Q: í”„ë¡œí¼í‹°ê°€ íŒŒì‹± ì•ˆë¼ìš”
**A:**
- `GENERATED_REFLECTION_BODY()` ë§¤í¬ë¡œ ìˆëŠ”ì§€ í™•ì¸
- `UPROPERTY()` ë§¤í¬ë¡œ ìˆëŠ”ì§€ í™•ì¸
- ì„¸ë¯¸ì½œë¡  `;` ë˜ëŠ” `=`ë¡œ ëë‚˜ëŠ”ì§€ í™•ì¸

### Q: í•¨ìˆ˜ê°€ ë°”ì¸ë”© ì•ˆë¼ìš”
**A:**
- `UFUNCTION(LuaBind)` ë§¤í¬ë¡œ ìˆëŠ”ì§€ í™•ì¸
- í•¨ìˆ˜ê°€ `{` ë˜ëŠ” `;`ë¡œ ëë‚˜ëŠ”ì§€ í™•ì¸

### Q: Generated í´ë”ê°€ ì—†ì–´ìš”
**A:**
- í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `Generated` í´ë” ìƒì„±
- ë˜ëŠ” ì½”ë“œ ìƒì„±ê¸°ê°€ ìë™ ìƒì„±í•©ë‹ˆë‹¤

---

## ğŸ‰ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] UPROPERTY, UFUNCTION ë§¤í¬ë¡œ ì •ì˜
- [x] Python ì½”ë“œ ìƒì„±ê¸° êµ¬í˜„
  - [x] parser.py (í—¤ë” íŒŒì‹±)
  - [x] property_generator.py (í”„ë¡œí¼í‹° ì½”ë“œ)
  - [x] lua_generator.py (Lua ë°”ì¸ë”©)
  - [x] generate.py (ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸)
- [x] Visual Studio Pre-Build Event í†µí•©
  - [x] Debug êµ¬ì„±
  - [x] Debug_StandAlone êµ¬ì„±
  - [x] Release êµ¬ì„±
  - [x] Release_StandAlone êµ¬ì„±
- [x] ìˆ˜ë™ ì‹¤í–‰ ë°°ì¹˜ íŒŒì¼
- [x] í…ŒìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ë¡œ ê²€ì¦
- [x] ë¬¸ì„œ ì‘ì„±
  - [x] ì‚¬ìš© ê°€ì´ë“œ
  - [x] í™œìš© ì‚¬ë¡€
  - [x] ì™„ë£Œ ë³´ê³ ì„œ

---

## ğŸ“ˆ í†µê³„

```
ì½”ë“œ ë¼ì¸ ìˆ˜:
- parser.py:               ~250 lines
- property_generator.py:   ~50 lines
- lua_generator.py:        ~60 lines
- generate.py:             ~100 lines
- Total:                   ~460 lines

ìƒì„±ë˜ëŠ” ì½”ë“œ:
- .generated.cpp íŒŒì¼:     40ê°œ
- í‰ê·  íŒŒì¼ í¬ê¸°:          ~30 lines
- ì´ ìƒì„± ì½”ë“œ:            ~1,200 lines

ì ˆê° íš¨ê³¼:
- ìˆ˜ë™ ì‘ì„± ì‹œê°„:          ~8ì‹œê°„ (40ê°œ íŒŒì¼)
- ìë™ ìƒì„± ì‹œê°„:          <1ì´ˆ
- ì‹œê°„ ì ˆê°:               99.9%
```

---

## ğŸ¯ í•µì‹¬ ì„±ê³¼

### 1. Unreal Engine ìˆ˜ì¤€ì˜ ê°œë°œ ê²½í—˜
í—¤ë” íŒŒì¼ì—ë§Œ ë§¤í¬ë¡œ ì¶”ê°€ë¡œ ëª¨ë“  ë°”ì¸ë”© ìë™í™”

### 2. íŒ€ ìƒì‚°ì„± ëŒ€í­ í–¥ìƒ
- ë°˜ë³µ ì‘ì—… ìë™í™”
- ì‹¤ìˆ˜ ë°©ì§€
- ìœ ì§€ë³´ìˆ˜ ê°„ì†Œí™”

### 3. í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜
- ë‹¤ë¥¸ ì–¸ì–´ ë°”ì¸ë”© ì¶”ê°€ ê°€ëŠ¥
- ë¬¸ì„œ/UI ìë™ ìƒì„± ê°€ëŠ¥
- í•« ë¦¬ë¡œë“œ ì‹œìŠ¤í…œ êµ¬ì¶• ê°€ëŠ¥

### 4. ì•ˆì •ì ì¸ ë¹Œë“œ í†µí•©
- Visual Studio ì™„ë²½ í†µí•©
- ëª¨ë“  ë¹Œë“œ êµ¬ì„± ì§€ì›
- ìˆ˜ë™/ìë™ ì‹¤í–‰ ëª¨ë‘ ì§€ì›

---

**í”„ë¡œì íŠ¸**: Mundi Engine
**ê¸°ìˆ  ìŠ¤íƒ**: C++20, Python 3, Lua, Jinja2
**í”Œë«í¼**: Windows (Visual Studio 2022)
**ì‘ì„±ì¼**: 2025-11-07
